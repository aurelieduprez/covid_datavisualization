<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <script src="//d3js.org/d3.v3.min.js"></script>
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/style/stylesheet.css" />
  </head>

  <body>
    <div id="content">
        <div id="welcome"></br></br>Data Analysis - Covid 19</div>
        <h2 id="firstChart">Spread of COVID-19 on March 31st, 2020 in France and worldwide</h2>
        <canvas id="chartCases" style="width: 512px; height: 256px"></canvas>
        <h2 id="secondChart">Number of deaths due to COVID-19 on March 31st, 2020 in France and worldwide</h2>
        <canvas id="chartPie"></canvas>
        <h2 id="thirdChart">Number of Cases and deaths on March 31st, 2020 in France and worldwide</h2>
        <canvas id="stackedBarChart"></canvas>
        <h2 id="fourthChart"> progress of COVID-19 in France between 1/1/2020 and 31/3/2020</h2>
        <canvas id="lineChart"></canvas>
        
    </div>
</br></br></br></br>
    <script>
      
      barChart();
      pieChart();
      stackedBarChart();
      lineChart();

      async function barChart() {
        //get france cases
        var franceAllCases = await $.get("http://localhost:8080/franceCasesMarch");
        console.log(franceAllCases);
        var nbFranceCases = 0;
        for (let i = 0; i < franceAllCases.length; i++) {
          nbFranceCases += parseInt(franceAllCases[i]);
        }
        console.log(nbFranceCases);
        //get worldwide cases
        var worldAllCases = await $.get("http://localhost:8080/worldCasesMarch");
        console.log(worldAllCases);
        var nbWorldCases = 0;
        for (let i = 0; i < worldAllCases.length; i++) {
          nbWorldCases += parseInt(worldAllCases[i]);
        }
        console.log(nbWorldCases);

        var ctx = document.getElementById("chartCases").getContext("2d");
        var chart = new Chart(ctx, {
          // The type of chart we want to create
          type: "bar",

          // The data for our dataset
          data: {
            labels: ["France", "Worldwide"],
            datasets: [
              {
                label: ["Cases"],
                backgroundColor: ["rgba(129,178,154, 0.8)", "rgba(129,178,154, 0.8)"],
                borderColor: ["rgb(255, 180, 162)", "rgb(129,178,154)"],
                data: [nbFranceCases, nbWorldCases],
                
              },
            ],
          },

          // Configuration options go here
          options: {},
        });
      }


      async function stackedBarChart() {

                var franceAllCases = await $.get("http://localhost:8080/franceCasesMarch");
        console.log(franceAllCases);
        var nbFranceCases = 0;
        for (let i = 0; i < franceAllCases.length; i++) {
          nbFranceCases += parseInt(franceAllCases[i]);
        }
        console.log(nbFranceCases);
        //get worldwide cases
        var worldAllCases = await $.get("http://localhost:8080/worldCasesMarch");
        console.log(worldAllCases);
        var nbWorldCases = 0;
        for (let i = 0; i < worldAllCases.length; i++) {
          nbWorldCases += parseInt(worldAllCases[i]);
        }
        console.log(nbWorldCases);
        //get france cases
        var franceAllDeaths = await $.get("http://localhost:8080/franceDeathsMarch");
        console.log(franceAllDeaths);
        var nbFranceDeaths = 0;
        for (let i = 0; i < franceAllDeaths.length; i++) {
          nbFranceDeaths += parseInt(franceAllDeaths[i]);
        }
        console.log(nbFranceDeaths);
        //get worldwide cases
        var worldAllDeaths = await $.get("http://localhost:8080/worldDeathsMarch");
        console.log(worldAllDeaths);
        var nbWorldDeaths = 0;
        for (let i = 0; i < worldAllDeaths.length; i++) {
          nbWorldDeaths += parseInt(worldAllDeaths[i]);
        }
        console.log(nbWorldDeaths);

        var cty = document.getElementById("stackedBarChart").getContext("2d");
        var chart2 = new Chart(cty, {
          // The type of chart we want to create
          type: "bar",

          // The data for our dataset
          data: {
            labels: ["Worldwide", "France"],
            datasets: [
              {
                label: "Deaths",
                backgroundColor: ["rgb(58, 80, 107)", "rgb(58, 80, 107)"],
                borderColor: ["rgb(58, 80, 107)", "rgb(58, 80, 107)"],
                data: [nbWorldDeaths, nbFranceDeaths],
                id: ['yAxis1', 'yAxis2']
              },
              {
                label: "Cases",
                backgroundColor: ["rgba(129,178,154, 0.8)", "rgba(129,178,154, 0.8)"],
                borderColor: ["rgb(233, 196, 106)", "rgb(74, 78, 105)"],
                data: [nbWorldCases, nbFranceCases ],
                id: ['yAxis1', 'yAxis2']
              }
            ],
          },

          // Configuration options go here
          options: {        
              scales: {
            xAxes: [{
                stacked: true
            }],
            yAxes: [{
                stacked: true,
                id: 'yAxis1',
                position: 'left'
            }],
            responsive: true
        }},
        });
      }

      
            async function pieChart() {


        //get france deaths
        var franceAllDeaths = await $.get("http://localhost:8080/franceDeathsMarch");
        console.log(franceAllDeaths);
        var nbFranceDeaths = 0;
        for (let i = 0; i < franceAllDeaths.length; i++) {
          nbFranceDeaths += parseInt(franceAllDeaths[i]);
        }
        console.log(nbFranceDeaths);
        //get worldwide deaths
        var worldAllDeaths = await $.get("http://localhost:8080/worldDeathsMarch");
        console.log(worldAllDeaths);
        var nbWorldDeaths = 0;
        for (let i = 0; i < worldAllDeaths.length; i++) {
          nbWorldDeaths += parseInt(worldAllDeaths[i]);
        }
        console.log(nbWorldDeaths);

        var cty = document.getElementById("chartPie").getContext("2d");
        var chart2 = new Chart(cty, {
          // The type of chart we want to create
          type: "pie",

          // The data for our dataset
          data: {
            labels: ["Worldwide", "France"],
            datasets: [
              {
                label: "Deaths",
                backgroundColor: ["rgba(129,178,154, 0.8)", "rgb(58, 80, 107)"],
                borderColor: ["rgba(129,178,154, 0.8)", "rgb(58, 80, 107)"],
                data: [nbWorldDeaths, nbFranceDeaths],
              },
            ],
          },

          // Configuration options go here
          options: {maintainAspectRatio: true,},
        });
      }


        async function lineChart() {

        var franceDates = await $.get("http://localhost:8080/getDaysFrance");
        var orderedDates = [];
        for (let i = 0; i < franceDates.length - 1; i++) {
        orderedDates.unshift(franceDates[i]);
        }
        console.log(orderedDates);

        var franceAllCases = await $.get("http://localhost:8080/franceCases");
        console.log(franceAllCases);
        var orderedCases = [];
        for (let i = 0; i < franceAllCases.length - 1; i++) {
        orderedCases.unshift(franceAllCases[i]);
        }
        console.log(orderedCases);




        var ctx = document.getElementById("lineChart").getContext("2d");
        var chart2 = new Chart(ctx, {
          // The type of chart we want to create
          type: "line",

          // The data for our dataset
          data: {
            labels: orderedDates,
            datasets: [
              {
                label: "Cases",
                backgroundColor: "rgba(129,178,154, 0.8)",
                borderColor: "rgba(129,178,154, 0.8)",
                data: orderedCases,
              },
            ],
          },

          // Configuration options go here
          options: {maintainAspectRatio: true,},
        });
      }
      

    </script>
  </body>
</html>
